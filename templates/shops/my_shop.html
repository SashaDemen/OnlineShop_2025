
{% extends "base.html" %}
{% block content %}
<div class="shop-banner">
  {% if shop and shop.banner %}
    <img src="{{ shop.banner.url }}" alt="Banner" class="banner">
  {% else %}
    <img src="{% static 'img/shop_banner.jpg' %}" alt="Banner" class="banner">
  {% endif %}
  {% if shop and shop.avatar %}
    <img src="{{ shop.avatar.url }}" class="shop-avatar" alt="Avatar">
  {% else %}
    <img src="https://via.placeholder.com/80" class="shop-avatar" alt="Avatar">
  {% endif %}
</div>

{% if shop %}
  <h2 class="shop-title">{{ shop.name }}</h2>
  <p class="text-muted">{{ shop.description }}</p>
  <div class="mb-3">⭐ {{ shop.rating_avg }} ({{ shop.rating_count }} відгуків)</div>
  <a class="btn btn-primary mb-4" href="{% url 'edit_shop' %}">Редагувати магазин</a>

  <h4>Товари магазину</h4>
  <div class="row row-cols-1 row-cols-md-3 g-3">
    {% for product in shop.products.all %}
    <div class="col">
      <div class="card h-100">
        {% with img=product.images.first %}{% if img %}
          <img src="{{ img.image.url }}" class="card-img-top" alt="{{ product.title }}">
        {% endif %}{% endwith %}
        <div class="card-body">
          <h5 class="card-title">{{ product.title }}</h5>
          <p class="card-text">{{ product.description|truncatechars:100 }}</p>
        </div>
        <div class="card-footer d-flex justify-content-between">
          <strong>{{ product.price }} {{ product.currency }}</strong>
          <a class="btn btn-sm btn-primary" href="{% url 'product_detail' product.slug %}">Купити</a>
        </div>
      </div>
    </div>
    {% empty %}
      <p>У цього магазину поки що немає товарів.</p>
    {% endfor %}
  </div>
{% else %}
  <p>У вас ще немає магазину.</p>
  <a class="btn btn-primary" href="{% url 'edit_shop' %}">Створити</a>
{% endif %}
{% endblock %}
